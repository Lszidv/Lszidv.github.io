## 摘要
  根据地震波形的特点设计了四种具有不同复杂度的深度神经网络改进模型，可以综合具体的精度和速度需求从中选取合适的模型，将改进模型与现有四种到时拾取的深度学模型作对比。

## 引言
  直接输入原始三分量波形，简化预处理步骤
```
全连接网络（FCN）：最早用于震相拾取的神经网络模型是多层感知器（MLP），但其缺乏有效的信号处理能力，难以取得较好的结果。
卷积神经网络（CNN）：能够有效处理波形数据，因此在震相拾取中取得了较好的效果。CNN 通过对波形数据的提取简化了震相到时的处理过程，并且有些结合卷积与全连接网络的算法取得了较高的精度。
编码解码模型（CNN + 解码结构）：采用了卷积反卷积结构，提升了震相拾取的精度，且对噪声具有更强的鲁棒性。该模型借鉴了 U-Net 网络结构。
循环神经网络（RNN）：RNN 设计的初衷是解决自然语言处理中的前后文问题，适合处理震相拾取中需要考虑前后震相信息的任务。特别是双向 RNN（Bi-RNN）和门控循环单元（GRU）能处理更长时间依赖，提升了震相拾取的准确性。
```
问题：未考虑地震波形特点，网络模型过于复杂，关系依赖不明确。
方法：综合考虑模型合理性、精度和速度的深度神经网络模型设计方案

## 1.深度神经网络基本结构
  用于震相拾取的深度学习算法更加接近信号处理算法
1.1  卷积神经网络
```
通过计算输入信号和卷积核之间的相关性来提取特征
边界处理（补零）
可以通过增加步长（卷积核每次滑动的距离）进行下采样（降低维度）
池化层用于对卷积操作后的特征图进行降采样，如最大池化（Max Pooling） 和 平均池化（Average Pooling），其具有平移不变性，在震相拾取中帮助模型识别不同位置的特征
感受野是卷积后的信号中每个采样点所对应原始信号的采样点个数，扩张卷积在卷积核之间插入空洞（零填充）来增加感受野，但计算量和参数数量保持不变。
转置卷积（反卷积）与传统卷积不同，首先进行上采样（即放大图像或信号），然后通过普通卷积对上采样后的图像进行处理。它通常用于编码解码结构中，用于恢复特征图的尺寸。
```
1.2 循环神经网络
```
其网络结构源于马尔可夫（Markov）随机过程，即网络的输出仅取决于上一步的输入
文中使用了 GRU（门控循环单元）作为 RNN 的改进，GRU 是 LSTM（长短时记忆网络）的变种
```
1.3 批正则化层
```
BN层通过将每一层的输入进行归一化处理，使得训练过程更加稳定，缓解了梯度消失问题，并且能够有效避免过拟合
```
## 2.用于震相拾取的深度学习模型
2.1 到时拾取网络的设计与改进
  人脸识别一般使用3×3卷积核，而地震波形特征尺度较大，简单模仿图形处理模型会导致特征拾取不完整
  部分研究使用RNN解决长时间依赖，但RNN训练和推断速度慢，数据量过大时可能难以收敛，而更深的卷积神经网络虽然能提取更复杂的特征，但是会导致计算量的增加
   文中使用Wavenet模型，结合扩张卷积来增加感受野，使用5×5卷积核，由于时一维时序数据处理，所以不会显著增加模型复杂度
  传统CNN未对输入进行筛选和加权（低信噪比低权重），这会让模型易受到噪声干扰，使用门控CNN，计算每个特征的门控值，重要的波形特征中，门控单元会给出接近 1 的输出值，表示这些特征应该被保留和加强；而对于不重要或噪声较大的特征，门控单元的输出接近 0，表示这些特征应被忽略。为减轻梯度消失问题，加快训练过程，加入残差网络结构  
![wavenet结构](https://github.com/user-attachments/assets/8970c417-4ba2-4291-8af0-59b855af61a6)

较大感受野难以捕捉到较小地震的震相特征，将每层输出结果加和，更加符合不同震级震相拾取的需要
为降低计算效率，将其简化为7层，保持纯卷积结构，使用空洞卷积，增加感受野
使用深度可分离卷积，进一步减少参数数量
```
传统卷积神经网络: K×C1×C2
深度卷积：K×C1
逐点卷积：C1×C2
```
使用LeakyReLU作为激活函数，LeakyReLU＝max（0.25x，x）
此外，在一些半精度和单精度计算效率不同的设备上，使用半精度替代单精度（深度学习数值精度对分类性能影响较少）[cpu计算]

2.1 其它用于到时拾取的深度学习模型
  三层CNN
![表2](https://github.com/user-attachments/assets/e001c45a-7f38-41be-b409-e32b6d4c0a97)
```
5*5  添加BN层
仅依赖感受野，无法捕捉时序特征
```
双向RNN
![bi RNN](https://github.com/user-attachments/assets/ab286080-584c-4a2f-bad7-be8d8c0ac6fe)

```
Bi-RNN，并结合CNN处理原始波形
推理速度慢，需要较多资源
```
![箱形图](https://github.com/user-attachments/assets/9869a044-1f9b-4ca4-870b-6b6fc64ead49)

稀疏编码模型（编码解码模型/U-Net）
![表三](https://github.com/user-attachments/assets/303cb0a4-4477-45b3-b60d-9296adf442f7)

```
多层卷积层，池化层（降采样），转置卷积（上采样），添加BN层，【点对点输出】
模型更加复杂，计算量更大
```
## 3.网络性能对比分析
3.1 训练和测试数据
```
使用波数法合成14万条数据，选取1500条作为测试数据（震中距 20—470 km 范围内的台站，台站为任意方位角；震源深度为 4—19 km，震级 MW3.0—6.0，其它震源参数随机，噪声方差为0.1和0.3）
单条数据采样点1024，采样间隔0.2s,即为204.8秒的地震波形
生成数据不经过滤波，使用方差归一化，使用单一垂向分量波形进行震相拾取，加入方差为 0—0.2 的噪声
标注波形，将正确到时（计算）前两个采样点作为正样本，其它作为负样本
作为分类问题，负样本过多，因此对正样本以及 P 波与 S 波之间的波形加入权值 5，负样本加权值为 0.1
标签数据使用独热编码（OneHot）对震相类型进行标注
```
![训练数据](https://github.com/user-attachments/assets/2a163126-1125-489e-83f1-eebc8f35b644)

波数是描述波的空间频率的量度，它与波长（wavelength）和频率（frequency）相关。
在地震学中，波数法被用于生成虚拟地震数据。通过模拟不同震源、介质、波形等因素，生成用于模型训练的数据。
需要准确的介质模型和波传播参数才能产生高质量的模拟数据。

独热编码（One-Hot Encoding）是一种常用的分类数据转换方法，它将每个类别映射到一个 二进制向量 中，在这个向量中，只有与该类别对应的位置为 1，其他位置为 0。独热编码常用于机器学习和深度学习中，用来处理类别型特征，使其适应模型的训练需求。例如P 波[1,0,0]S 波 [0,1,0]和 面波[0,0,1]

3.2 网络规模和推断速度测试
```
 网络规模、可训练参数数量、推断时间 和 硬件（CPU 和 GPU）性能的关系
```
![性能统计](https://github.com/user-attachments/assets/12c9e443-0caa-4b3c-aceb-d96a162e4805)

3.3 分类性能测试
```
测试数据中，如果一个震相的到时被识别为跨越超过 3 个采样点（0.6秒），被归类为负样本
最优性能：CNN+biRNN  , Wavenet（扩张卷积） 说明增加感受野来捕捉更长时间依赖，均可以达到较好的结果。
所有模型在 S 波 提取任务上的效果均好于 P 波[S波的振幅和持续时间相对较长，而P波由于振幅原因容易被噪声掩盖]（见图5）
使用箱形图（Box Plot）对震相到时提取误差进行了分析，P 波的到时误差相比S波更小[P波样本较少被正确提取，S波的误差较大]（图6）
CNN+biRNN与Wavenet类似
```
![ROC](https://github.com/user-attachments/assets/48bc2bc3-1a2a-4f32-ab75-4cb225e2a76e)
![箱形图](https://github.com/user-attachments/assets/9d16f424-74c5-455a-84b5-b75fe0843049)
3.4 抗干扰测试
不同网络结构在噪声环境下对震相拾取（特别是 P 波 和 S 波）的误差分析
信噪比（SNR）：定义为地震波形的方差与噪声方差之比
![噪声影响Figure7](https://github.com/user-attachments/assets/e8c682b0-d998-4f7a-ba68-600b3a710b87)
```
_近震测试结果_
近震波形中，体波振幅较大，震相的信号在噪声中的相对强度较高，容易被模型准确识别
感受野有限的三层网络，只能识别局部特征，无法捕捉较长时间的波形信息，可能将面波错误地识别为S波
```
```
_远震测试结果_
P 波的识别困难：远震波形测试中，P 波的信号较弱，通常振幅较小，容易被噪声覆盖，测试中，P 波的所有概率均未超过 0.25%，即 P 波未能成功拾取。
S 波的优势：相比于P波，S波的振幅通常较大，而且可以通过面波的协同判断来辅助拾取
```
```
编码解码结构、RNN网络和WaveNet在具有大感受野的网络中,均能够有效识别S波
具有较大感受野的网络（如 RNN 和 WaveNet）通常能获得较好的拾取精度。
```
## 4.结果与讨论
WaveNet 与RNN融合模型的精度相近
GPU 场景下，尽管WaveNet的计算复杂度较高，但其速度比RNN融合模型快约 6 倍，biRNN受顺序影响（需要反向输入），速度较慢
优化后的 7 层卷积神经网络参数相对较少，具有较低的计算复杂度，适合于低功耗设备
多台站数据结合和硬件优化是未来进一步提升震相拾取精度和加速推断速度的关键方向。
[论文链接]（https://www.dzxb.org/article/doi/10.11939/jass.20190154）