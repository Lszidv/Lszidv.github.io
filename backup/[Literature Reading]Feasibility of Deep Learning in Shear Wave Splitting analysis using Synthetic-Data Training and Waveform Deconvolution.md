## Abstract

背景与传统方法：传统方法通过逆转分裂过程，通过频域和时域操作，最小化波形切向能量，得到分裂参数。
swsnet模型：自动化从预选波形中提取分裂参数
合成数据训练：缺乏标注数据，生成合成数据集

模型性能：在带噪声的合成测试数据上，SWSNet能够以9.7°（φ）和0.14秒（δt）的均方根误差（RMSE）进行预测
实际数据应用：实际的USArray数据集，通过去卷积步骤对波形进行预处理，使其均匀化。
模型在实际数据上的表现与以往的研究一致，预测结果的平均绝对差为9.6°（φ）和0.16秒（δt）

## 1.Introduction
&emsp;研究背景
地震各向异性分析是地球动力学研究的重要手段，通过S波分裂技术获取地幔内部的动态信息，为理解地幔流动和变形提供了数据支持。

&emsp;各向异性的形成机制
应变诱导晶格优选取向（LPO）：由橄榄石等上地幔矿物在应变条件下排列导致。
形状优选取向（SPO）：由垂直排列的充液裂隙和裂缝引起。
两种机制共同作用，塑造了地幔的各向异性特性。

&emsp;分裂参数的意义
快波方向（φ）反映各向异性材料的取向，与局部应力场和流动方向密切相关。
时间延迟（δt）量化各向异性强度及其影响范围，提供了对地幔结构深度和复杂性的认识。

&emsp;XKS相位的应用
作为研究地震各向异性的主要工具，XKS相位（包括SKS、SKKS和PKS）因其与核幔边界的极化特性，广泛应用于研究深部地幔的动力过程。
波在核幔边界的转换会使得其初始极化方向（未进入各向异性介质时）与震中背方位角一致。
这是因为转换过程中，核幔边界对波动方向的约束与震中到接收点的传播路径成固定关系。

尽管已有多种传统方法（如网格搜索、相关分析）和（半）自动化技术，但这些方法受限于效率和适应性，缺乏对深度学习潜力的全面探索。

&emsp;未来展望:
通过扩大标注真实数据集，进一步提高模型的泛化能力。
探索多层各向异性假设及更复杂的模型，增强实际应用价值。
将深度学习技术推广至更多地震学任务，为研究地球内部动力学提供新工具。

## 2.Methods and Results
监督学习方法，通过标注数据训练深度学习模型，旨在实现从波形到分裂参数（φ和δt）的映射关系。模型通过优化损失函数，最小化预测值与真实值之间的误差。
生成合成波形以替代真实数据，确保标注数据的可用性和一致性。

#### 2.1 剪切波分裂模型
&emsp;剪切波分裂的基本原理：
单一各向异性层模型：假设各向异性层具有水平对称轴（快轴），垂直入射的剪切波分裂为快波和慢波，快波平行于对称轴，慢波垂直于对称轴。
![坐标系](https://github.com/user-attachments/assets/a7e4186e-c2f4-48b3-bd4a-a01938fa1b5d)

&emsp;数学描述与简化：
频域方程：通过矩阵形式表达剪切波分裂后的径向和横向位移分量，揭示了其与震中背方位角和快轴方向的关系。
低频近似：在周期较长的情况下，方程得到简化，为数据处理（如去卷积和再卷积）提供了可行的数学框架。

$$
\begin{bmatrix}
u^{(r)}_1 \\ 
u^{(t)}_1 
\end{bmatrix}=
\begin{bmatrix}
\cos \theta + i \sin \theta \cos 2\alpha & i \sin \theta \sin 2\alpha \\ 
i \sin \theta \sin 2\alpha & \cos \theta - i \sin \theta \cos 2\alpha 
\end{bmatrix}
\begin{bmatrix}
u^{(r)}_0 \\ 
u^{(t)}_0 
\end{bmatrix}
$$

其中：

- $\theta = \frac{\omega \delta t}{2}$
- $\alpha = \beta - \phi$ 是震中背方位角与快轴方向之间的角度差
- 下标 $0$ 表示波形进入各向异性层之前的状态

对于径向对称地球中的 XKS 相位，可以假设 $u^{(t)}_0 = 0$，则简化为：

$$
u^{(r)}_1 = \left(\cos \theta + i \sin \theta \cos 2\alpha \right) u^{(r)}_0
$$
$$
u^{(t)}_1 = i \sin \theta \sin 2\alpha u^{(r)}_0
$$

在长周期（ $T \gg \delta t$ ）的近似下，进一步简化为：

$$
u^{(r)}_1 \approx \left(1 + i\frac{\omega \delta t}{2}\cos 2\alpha\right) u^{(r)}_0
$$
$$
u^{(t)}_1 \approx i\frac{\omega \delta t}{2} \sin 2\alpha u^{(r)}_0
$$

#### 2.2 DL分析——合成数据
```
使用合成数据训练模型，覆盖多种地震波传播路径与快轴方向组合。随机生成的 𝛿𝑡和 𝜙增强了数据的多样性。
样本总数达到10^6，数据按 80:20 分为训练集与验证集。
结合卷积层（特征提取）与 Bi-LSTM 层（时间依赖性建模），以捕获地震波形的空间与时间特性。
使用 ReLU 激活函数和 Sigmoid 激活函数，分别用于回归和分类任务。
使用 Adam 优化器、早停机制（验证集损失不下降8轮即停止），避免过拟合。模型最终在35轮内完成训练。
模型输出包括非零分裂概率以及归一化后的 𝛿𝑡 和 𝜙，实现剪切波分裂的自动化分析。
```


##### 2.2.1 结论——合成数据
```
在训练数据中对快波和慢波分量独立添加噪声，使用随机噪声和高斯噪声两种类型。
噪声水平为正态分布，均值为30%，标准差为10%，模拟了复杂且具有随机性的真实噪声条件。

在随机噪声测试集上，模型预测的 RMSE 为 5.9 °（𝛼）和 0.12 秒（𝛿𝑡），表现出高精度。
```
![随机噪声](https://github.com/user-attachments/assets/44987727-716d-4f68-99c5-a9e960ea883d)
![高斯噪声](https://github.com/user-attachments/assets/3b518f51-5e15-488b-9987-541d3c5116ed)

#### 2.3 应用USarray上的真实数据
```
研究使用USArray的真实地震波形测试，并将结果与传统方法（如Liu et al., 2014）和自动化方法（Splitracer工具箱）进行对比。
通过严格的质量检查，使用横向分量能量减少率（≥60%）筛选高质量数据，保证了分裂参数平均值的可靠性。

直接将基于合成数据训练的模型应用于真实波形时，结果与传统方法之间存在显著偏差。
原因是合成波形在物理特性和复杂性上无法完全模拟真实数据。
合成数据与真实数据之间的特性差异需要通过中间步骤来弥合。(可以包括数据校正、去卷积或增强模型对真实数据的适应性。)
```
#### 2.4 反卷积
```
真实波形的复杂性受到震源机制和路径效应的影响，给直接分析带来了挑战。
去卷积方法通过去除震源和路径效应，统一波形特性，为剪切波分裂参数的提取奠定基础。

径向分量被归一化为标准值1，用作基准。
横向分量中的分裂特征被提取，通过频域导数和调制操作进行量化。

方法假设径向分量在进入各向异性层前未受影响，适用于波形周期远大于延迟时间的情况。
通过参考波形的卷积处理，进一步标准化波形，以提高后续分析的准确性。
```
我们在频域中对径向分量和横向分量进行去卷积，具体公式如下：

$$
u^{(r)}_* = \frac{u^{(r)}_1}{u^{(r)}_1} 
$$

$$
 \quad u^{(t)}_* = i\omega \frac{\delta t}{2} \sin 2\alpha \frac{u^{(r)}_0}{u^{(r)}_1} \approx i\omega \frac{\delta t}{2} \sin 2\alpha
$$

其中，假设：

$$
\frac{u^{(r)}_0}{u^{(r)}_1} \approx 1
$$

这意味着径向分量足以代表未进入各向异性层前的波形。

结果表明：

- 径向分量在频域中被归一化为 1，对应于时域中的 $\delta$ 函数。
- 横向分量由 $\sin 2\alpha$ 调制，且包含了剪切波分裂信息。
- 
```
解决真实波形由于震源机制、路径效应和噪声干扰引起的复杂性。
应用反卷积去除震源和路径效应，使径向分量成为标准化的输入。
使用规范化的波形与数据重新卷积，以实现波形特征的统一化。
进一步处理时仅保留横向分量作为剪切波分裂参数（快轴方向 $\alpha$ 和时间延迟 $\delta t$）的主要信息载体。


```

#### **1. 数据准备**
1. **波形选择**：
   - 选取目标地震事件的径向分量 ($u^{(r)}$) 和横向分量 ($u^{(t)}$)，对应特定的时间窗口。
   - 对真实数据进行重新采样，采样频率统一为 50 Hz，并去除均值。

2. **初步平滑与标准化**：
   - 对波形应用 **Hanning 窗**，以平滑时间窗口边界，减少边界效应。
   - 对数据进行 **零填充 (zero-padding)**，使每个样本均匀包含 2000 个采样点，覆盖 40 秒时间窗口。

3. **滤波去噪**：
   - 使用 **Butterworth 低通滤波器**（截止频率 1 Hz），抑制高频噪声，同时保留主要的波形特征。

---

#### **2. 反卷积与重卷积：波形标准化**
1. **反卷积处理**
     - 将径向分量 ($u^{(r)}$) 作为参考，从径向分量和横向分量中分别去除震源效应和路径效应。
     - 简化后的横向分量中，仅包含与分裂参数α，δt相关的特征。
     - 假设径向分量波形是入射波形的充分代表（即 $u^{(r)}_0/u^{(r)}_1 \approx 1$）。
   - 去除路径效应后，横向分量的主要特征变为振幅由 $\sin 2\alpha$ 调制，并包含 $\delta t$ 的信息。

3. **重卷积处理**：
   - 将标准波形（如归一化的指数函数导数）与反卷积后的径向分量和横向分量进行 **重卷积**，以生成标准化波形。
   - 对横向分量再应用 **Hanning 窗**，减弱可能出现的余弦振荡效应。

4. **最终标准化**：
   - 截取波形的中央 10 秒，去除无关的边界信号。
   - 对横向分量进行 **归一化**，确保振幅的绝对最大值为 1。

---

#### **3. 深度学习模型（SWSNet）训练**
1. **数据输入与特征**：
   - 输入数据仅包含反卷积与重卷积后的横向分量，以降低数据维度并突出有效信息。
   - 波形标签 $\alpha$和 $\delta t$均归一化至 [0, 1] 区间，促进训练稳定性和收敛速度。

3. **模型架构设计**：
   - **网络组成**：
     - 卷积层用于提取波形特征。
     - ReLU（Rectified Linear Unit）作为激活函数，提高非线性拟合能力。
     - Dropout 层防止过拟合。
     - 输出层包括三个节点，分别对应：
       - 测量为非零（non-null）的概率（Sigmoid 激活）。
       - 归一化的 $\alpha$ 和 $\delta t$ 预测值（ReLU 激活）。
   - **超参数优化**：
     - 选择合适的卷积核大小、网络层数和 LSTM 层维度。
     - 使用 Adam 优化器，批次大小为 256。
     - 提前停止（Early Stopping）：当验证集损失连续 8 个 Epoch 不再下降时，停止训练。
   - **最佳训练规模**：
     - 通过实验确定训练数据规模为 10^6 个波形，以确保模型在训练过程中性能的稳定性和泛化能力。

4. **训练与验证**：
   - 在合成波形（包括随机噪声和高斯噪声）上进行训练和验证。
   - 为提高模型对噪声数据的适应能力，分别测试添加随机噪声和高斯噪声的效果。
---

#### 2.5 在USarray上的应用
```
阈值优化
使用 SWSNet 分析 USArray 数据时，选择 60% 的横向分量能量减少阈值最为合适。该阈值不仅降低了分裂参数测站平均值的绝对误差，还保留了足够多的有效测站。

筛选结果
从 106,323 条波形中筛选出 8.2%（8699 条）作为有效波形，与 Link 等 (2022) 报告的 7.6% 相近，表明筛选标准具有一致性。

分裂参数性能对比
图 6 和表 1 展示了 SWSNet 在单个波形上的分裂参数，与 SplitRacer 工具计算的参数相近，表明模型具有较好的可靠性。

随机噪声 vs 高斯噪声
实验发现，虽然两种噪声训练的模型在合成数据集上表现相当，但随机噪声训练的模型在真实数据上的表现更优，可能由于其避免了高斯噪声训练中的过拟合问题。

对测站平均结果的可视化
图 7 展示了 SWSNet 和 Liu 等 (2014) 分析的测站平均结果的对比。SWSNet 未采用联合分裂分析，与 Liu 等的基于单个分裂相位平均的分析方法更为直接可比。
```
![Figure6](https://github.com/user-attachments/assets/a6c1d021-c502-43de-88e5-adc3aea611b6)
![7](https://github.com/user-attachments/assets/16944e12-7038-41d4-a490-5060f06db868)

## 3.Discussion
```
1. SWSNet 的整体表现
精确性：SWSNet 和传统方法（如 Liu 等，2014）在数据集选择(人工；波形的筛选采用了 60% 横向分量能量减少的阈值)和处理方式不同
对单个波形的预测，φ 和 δt 的平均绝对误差分别为 11.08° 和 0.239 s，表明模型的预测具有较高的可信度。
适应性：SWSNet 能够适应多种噪声条件（如随机噪声和高斯噪声），对实际数据的应用显示出较好的泛化能力。此外，模型可以有效处理多层各向异性条件下的复杂波形，预测结果与理论曲线吻合良好。

2. 多层各向异性情况下的表现
多层条件验证：通过模拟两层各向异性的波形数据，SWSNet 成功预测了有效延迟时间及其随背方位角的变化，与理论模型（Silver 和 Savage，1994）一致。
边界情况处理：在 null 测量条件下（横向分量很小的情况），尽管部分预测出现小幅偏差，但整体性能仍优于传统方法。

3. 时间效率的显著提升
效率优势：SWSNet 的计算效率显著高于传统网格搜索算法。在计算单个波形的分裂参数时，SWSNet 平均耗时仅为网格搜索的 1/3 至 1/6。对于大规模地震台阵（如 USArray 数据集）的分析，这一效率优势尤为突出。
可扩展性：基于其时间效率，SWSNet 可广泛应用于高分辨率的实时地震监测系统。

4. 数据筛选与可靠性改进
横向能量减少阈值：应用能量减少阈值（60%）来筛选波形，显著提高了站点平均值的计算精度。这种方法无需依赖先验知识，且适用于多层各向异性复杂条件。
一致性验证：通过对 SWSNet 和 Liu 等（2014）使用的相同波形子集进行对比分析，进一步验证了 SWSNet 的可靠性。

5. 局限性与优化方向
横向分量依赖：由于 SWSNet 的训练和预测仅依赖于去卷积后的横向分量，可能在某些低振幅横向分量的情况下降低性能。
噪声影响：尽管模型能适应不同类型的噪声，但随机噪声训练数据在实际数据中的表现更优，说明模型对噪声特性建模的重要性。
```
## 4.Conclusion
提出了 SWSNet，这是一种基于深度学习的剪切波分裂参数提取模型，具有替代传统网格搜索方法的潜力。
利用去卷积方法解决了真实波形与合成波形之间的差异问题，使得模型能够在真实数据中表现更好。
将模型应用于 USArray 数据集，显示出与传统方法（如 Liu et al., 2014）的结果一致性，同时显著提高了计算效率。

[Paper Link](https://seismica.library.mcgill.ca/article/view/1124)