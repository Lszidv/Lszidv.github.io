# Abstract
- **地震事件探测** 和 **震相拾取** 是许多地震学工作流程的基础。
- 由于不同研究的数据集和评估任务各异，目前尚不清楚不同方法之间的 **具体比较情况**。并且 **缺乏关于模型跨领域性能的系统性研究**。
- 本文通过 **大规模基准测试** 研究：
  - 评估六种深度学习模型;在八个数据集上进行测试
  - 任务包括 **事件检测、震相识别、震相到时拾取**
  - 结果与 **经典 Baer-Kradolfer 震相拾取器** 进行比较

- **跨区域研究** 发现：
  - 训练好的模型 **在不同地区之间可迁移**，但性能略有下降
  - **区域性数据训练的模型不适用于远震数据**
- 代码基于 **标准化框架**，确保可扩展性，并 **开放访问**；提供所有训练好的模型 **SeisBench 框架** 以便用户使用。

# 1. Introduction
## **深度学习在地震事件检测与震相拾取中的应用**
- 近年来，多个 **深度学习模型** 被提出用于 **地震检测和震相拾取**：
  - **PhaseNet (Zhu & Beroza, 2019)** - 基于 U-Net 结构，用于实时震相拾取。
  - **EQTransformer (Mousavi et al., 2019)** - 结合 CNN 和 Transformer，用于事件检测和震相拾取。
  - **GPD (Ross et al., 2018)** - 使用深度卷积网络，专注于震相识别。

## **本研究的核心目标**
- 提供一个 **全面的基准测试（benchmark）**，对比不同深度学习方法在地震检测和震相拾取任务上的性能。
- 重点关注 **单台站方法**，因为目前尚缺乏足够的 **多台站联合拾取方法**。
- 评估 **七种模型**（包括 **一种经典方法** + **六种深度学习方法**），在 **八个数据集** 上测试其优缺点。

## **数据集的多样性**
- 数据集覆盖 **不同规模、不同地区**，包括：
  - **本地地震（Local earthquakes）**
  - **区域地震（Regional earthquakes）**
  - **远震（Teleseismic earthquakes）**
- 这些数据采用 **不同的震相拾取策略**，确保基准测试的全面性。

## **深度学习模型的多样性**
- **架构差异**：CNN、RNN、Transformer。
- **输入数据类型**：
  - **时间域表示**（原始波形）
  - **频率域表示**（傅里叶变换后的数据）
- **输出方式**：
  - **单点预测**（震相到时）
  - **序列预测**（整个震相的时间序列）
- **模型规模**：从 **浅层模型**（少量网络层）到 **深度模型**（包含数十层）。

## **SeisBench 平台**
- **SeisBench**（Woollam et al., 2021）提供 **标准化的 API**，方便研究人员应用深度学习模型。
- 采用 **模块化设计**，允许：
  - 轻松添加 **新数据集** 进行评估。
  - 快速测试 **新模型** 并与已有方法对比。

## **技术实现**
- **PyTorch Lightning** (Falcon et al., 2019) - 提供高效的深度学习训练框架。
- **代码开放**：
  - 所有训练与评估代码均公开，便于研究人员 **复现实验**。
  - **未来模型开发者** 可以轻松将其方法与已有基准测试进行比较。
---
# 2. 数据与方法

## 2.1 任务与评估指标
模型在**输入波形长度** 和 **输出格式** 方面存在差异。  定义了 **三个通用任务**，并为每个模型设定了适用于该任务的评估方式。  
### 2.1.1 任务 1 —— 事件检测

#### **任务定义**
- **输入**：给定 **30 秒的地震波形窗口**。
- **目标**：判断该窗口内是否包含 **事件起始点**（即 **第一波震相到时**）。
- **数据处理**：
  - **剔除地震尾波（coda）**，因其是否应归类为事件仍存在不确定性。

#### **(1) 受试者工作特征曲线 (ROC) 和曲线下面积 (AUC)**
- **ROC 曲线**（Receiver Operating Characteristic）：
  - 通过 **真阳性率 (True Positive Rate, TPR) 与 假阳性率 (False Positive Rate, FPR)** 的变化关系，衡量模型在 **不同决策阈值** 下的性能。
  - **应用背景不同，所需的 FPR 和 TPR 取舍不同**：
    - **低地震活动区**（使用简单拾取关联算法）：需要 **FPR < 0.01**，避免误报过多。
    - **高地震活动区**（使用双曲拾取关联算法，如 Woollam et al., 2020）：**FPR < 0.05** 即可接受。

- **AUC（曲线下面积，Area Under Curve）**：
  - AUC = 1：**完美模型**（没有误判）。
  - AUC = 0.5：**随机猜测**（模型无效）。

#### **(2) F1 分数**
- **定义**：
  - **F1 分数**（F1-score）是 **精确率（Precision）和召回率（Recall）** 的调和平均数。
  - **Precision**（精确率）：正确检测到的事件占 **所有检测到的事件** 的比例。
  - **Recall**（召回率）：正确检测到的事件占 **所有实际发生的事件** 的比例。
  - **公式**：
 
$$  
    F1 = 2 \times \frac{{\text{Precision} \times \text{Recall}}}{{\text{Precision} + \text{Recall}}}
  $$
- **意义**：
  - **综合衡量模型的 "敏感性"（Sensitivity）和 "特异性"（Specificity）**。
  - **适用于地震事件检测**，因为它能权衡 **误报率（False Positives）与 漏报率（False Negatives）**。

- **F1 分数的阈值优化**： - **F1 依赖于决策阈值**，需要在不同应用场景下优化 **最优阈值**。

### 2.1.2 任务 2 —— 震相识别 (Phase Identification)

#### **任务定义**
- **输入**：一个 **10 秒的波形窗口**，其中包含 **一个震相**。
- **目标**：判断该震相是 **P 波** 还是 **S 波**（ **简化处理**：不进一步区分 ）

#### **与任务 1（事件检测）的区别**
- **任务 1（事件检测）**：区分 **地震事件** 和 **噪声**（类别划分清晰）。
- **任务 2（震相识别）**：区分 **P 波** 和 **S 波**，但两者类别划分是 **对称的**（没有固定的正负类）。

#### **评估指标**
| **指标** | **衡量内容** | **作用** |
|---------|------------|---------|
| **MCC（Matthews 相关系数）** | 计算混淆矩阵的相关性 | 适用于二分类问题，尤其适用于类别不均衡情况 |

- **为什么不用 AUC、ROC、F1 分数？**
  - 这些指标 **依赖于正负类别的定义**，但 P 波 vs. S 波 没有固定的正负类，因此不适用。
  - MCC **适用于对称二分类任务**，可稳定衡量 P/S 分类的准确性。

- **MCC 评分范围**：
  - **MCC = 1** → 完全正确分类； **MCC = 0** → 随机分类，无有效信息；**MCC = -1** → 完全错误分类。

- **阈值优化**：- MCC **受决策阈值影响**，需在 **2.5 章节** 进一步优化。

### 2.1.3 任务 3 —— 震相到时拾取 (Onset Time Picking)

### **任务定义**
- **输入**：一个 **10 秒的波形窗口**，包含一个 **已知类型（P 或 S）的震相**。
- **目标**：准确拾取 **震相到时**（Onset Time）。

#### **评估方法**
| **评估指标** | **作用** |
|-------------|---------|
| **残差（Residuals）** | 预测到时 vs. 真实到时的误差 |
| **高残差比例** | 计算误差超过设定阈值（0.45s/1.5s）的样本占比 |
| **RMSE（均方根误差）** | 受离群值影响较大，适用于整体误差评估 |
| **MAE（平均绝对误差）** | 受离群值影响较小，适用于稳定性评估 |

- **误差定义**：
  - **残差 = 机器学习预测的震相到时 - 真实参考震相到时**。
  - 误差越小，模型越精准。

- **分析方式**：
  - **直方图** 可视化残差分布，检测误差模式。
  - **RMSE vs. MAE 对比**：
    - **RMSE 更关注大误差**（适用于误差较大的情况）。
    - **MAE 更关注整体误差平均水平**（适用于误差较稳定的情况）。

## 2.2 数据集 (Datasets)

### **数据来源**
本研究在 **SeisBench** 平台上使用了 **八个数据集**：
- **六个数据集**（ETHZ, INSTANCE, Iquique, LenDB, SCEDC, STEAD）主要包含 **本地到区域地震事件（震中距 <10°）**。
- **两个数据集**（GEOFON, NEIC）主要包含 **远震事件（震中距 ≥10°）**。

### **数据集筛选**
| **数据集** | **事件类型** | **适用于任务** | **备注** |
|-----------|-----------|--------------|---------|
| **SCEDC** | 本地 & 区域地震 | 任务 1, 2, 3 | 超过 800 万条波形 |
| **ETHZ** | 本地 & 区域地震 | 任务 1, 2, 3 | 高质量人工标注 |
| **NEIC** | 远震 | 任务 2, 3 | 不适用于任务 1 |
| **LenDB** | 本地地震 | 任务 1 | 无人工 P/S 标注，排除任务 2, 3 |

### **数据标准化**
- **所有数据集重采样至 100 Hz**，确保模型公平评估。
- **数据集已预先划分为训练集、开发集和测试集**，以保证实验一致性。

## 2.3 已评估的模型概述
## **总结**
| **模型名称** | **任务支持** | **输入长度** | **网络结构** | **训练数据** | **适用场景** |
|-------------|-------------|-------------|--------------|--------------|-------------|
| **BasicPhaseAE** | 事件检测、震相识别、震相拾取 | **6s（100 Hz）** | U-Net | 智利 Iquique 11,000 震相数据 | 小型数据集，近场震相拾取 |
| **CRED** | 事件检测 | **30s（100 Hz）** | CNN + RNN | 北加州 55 万地震 + 55 万噪声 | 长时窗口事件检测，低信噪比环境 |
| **DPP** | 事件检测、震相拾取 | **5s（100 Hz）** | CNN + Bi-LSTM | 智利 Mw 8.1 & 7.7 震相数据 | 高噪声环境，数据有限场景 |
| **EQTransformer** | 事件检测、震相识别、震相拾取 | **60s（100 Hz）** | CNN + LSTM + Transformer | STEAD | 远震 & 复杂震相分析，自动化地震监测 |
| **GPD** | 事件检测、震相识别、震相拾取 | **4s（100 Hz）** | CNN | 南加州 450 万地震波形 | 短时窗口震相分类，远震低频震相检测 |
| **PhaseNet** | 事件检测、震相识别、震相拾取 | **30s（100 Hz）** | U-Net | 北加州 77.95 万震相数据 | 远震震相拾取，高噪声环境 |

- **BasicPhaseAE 适用于小型数据集的震相拾取**。
- **CRED 适用于长时窗口事件检测**，适合 **远震 & 低信噪比环境**。
- **DPP 适用于高噪声环境的震相拾取**，适合 **小型数据集**。
- **EQTransformer 适用于远震 & 复杂震相分析**，适合 **自动化地震监测**。
- **GPD 适用于短时间窗口震相分类**，适合 **实时地震检测**。
- **PhaseNet 适用于远震震相拾取**，适合 **高噪声环境**。

## 2.4 训练部分
- **基准测试基于 SeisBench 框架**，实现 **标准化数据处理和模型训练**。
- **采用混合窗口策略**，确保 **训练数据包含足够的震相样本，同时提升泛化能力**。
- **未对 P/S 波重新采样**，除 GEOFON 数据集外，P/S 样本未出现严重不均衡。
- **采用 Adam 优化器**，训练 **100 轮**，但受 **48 小时墙时限制**。
- **整个训练与评估消耗 4,000 GPU 小时 + 260,000 CPU 线程小时**，确保模型全面评测。

## 2.5 阈值和超参数选择
### **决策阈值选择**
- **任务 1（事件检测）**：优化 **ROC-AUC**，并提供 **F1 分数的最佳阈值** 作为参考。
- **任务 2（震相识别）**：优化 **MCC** 以选择 **P/S 波分类阈值**。
- **任务 3（震相拾取）**：基于 **开发集选择最佳决策阈值**，确保各数据集适应性。

### **超参数优化**
- **固定模型架构**，仅优化 **梯度下降参数**：
  - **批量大小（batch size）**：固定为 **1024**。
  - **学习率（learning rate）**：测试 **10⁻²、10⁻³ 和 10⁻⁴**。
- **模型选择标准**：
  - **AUC（任务 1）**
  - **MCC（任务 2）**
  - **标准偏差（任务 3）**
- **计算成本考虑**：
  - **未进行大规模超参数搜索**，因 Adam 优化器本身对超参数较为鲁棒（Kingma & Ba, 2014）。

## 2.6 基准方法（Baseline）
### **1. P 波拾取基准方法**
- 采用 **Baer-Kradolfer 拾取器**（Baer & Kradolfer, 1987）作为 P 波到时拾取的基准方法。
- **参数设定**：
  - **最小 & 最大事件检测时间**。
  - **双阈值设定**（第二个阈值为第一个阈值的一半）。
  - **带通滤波（Butterworth filter）** 以减少噪声。

### **2. 参数优化**
- **传统方法无法使用梯度下降优化**，需使用 **高斯优化（Gaussian Optimization）**：
  - 以 **RMSE（均方根误差）** 作为优化目标。
  - **25 个初始点，500 次进一步评估**。
- **优化计算成本**：
  - **仅在 2500 个 P 波拾取点上评估**，减少计算负担。

### **3. 未包含的基准方法**
- **未使用传统事件检测方法**，因其 **误报率高，无法直接比较**。
- **未使用 S 波拾取基准**，因 **传统 S 波拾取依赖额外信息（震源距离 & 方位角）**，参数调整难度较大。
---
# 3. Results




