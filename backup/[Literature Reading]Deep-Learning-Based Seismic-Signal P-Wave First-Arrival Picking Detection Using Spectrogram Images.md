## Abstract

- **P波首波拾取（First-Arrival Picking, FAP）** 对多个工业领域至关重要，包括**煤炭与石油勘探、隧道施工、水力压裂和地震预警系统**。
- 现有方法包括：
  - **人工识别**：耗时且易受主观误差影响。
  - **STA/LTA 算法**：基于**短时平均（STA）/长时平均（LTA）** 的比值计算，但在**实时背景噪声**下性能下降。
- **本研究提出了一种基于 U-Net 深度学习模型的新方法**，结合 **频谱图转换（Spectrogram Transformation）** 处理地震信号，以提高P波FAP的检测精度。
- **数据处理步骤**：
  1. **模拟地震信号**：使用 **随机模型仿真程序** 生成**类似于韩国地震环境**的地震信号。
  2. **添加高斯白噪声（WGN）**，模拟真实环境中的背景噪声。
  3. **转换为二维频谱图**，用于 **U-Net 模型训练**，确保高精度P波FAP检测。
- **实验结果**： **均方误差（MSE）**    **平均绝对误差（MAE）**    **均方根误差（RMSE）** 
---
## Introduction
 ### **1. 研究背景**
- **微震监测技术（Microseismic Monitoring Technology）** 的核心在于 **精准检测 P 波首波（FAP, First-Arrival Picking）**。
- **微震事件来源**：
  - **自然微震**：构造活动、火山喷发。
  - **工业诱发微震**：煤炭与石油勘探、隧道施工、水力压裂、地热发电。
- **水力压裂（Hydraulic Fracturing）** 作为 **页岩气开采的核心技术**，但 **可能增加地震活动风险**：**高压流体注入** 导致 **孔隙压力变化**，可能诱发地震。

### **2. 现有 P 波 FAP 检测方法及其局限性**

- **人工检测（Manual Detection）**：
  - **依赖地震学家的经验**，但 **耗时、数据密集，易受主观误差影响**，降低可靠性。
- **STA/LTA 算法（Short-Term Average / Long-Term Average）**：
  - 计算 **短时平均（STA）/ 长时平均（LTA）** 的比值，检测信号突变：
  
$$
    R(t) = \frac{\text{STA}(t)}{\text{LTA}(t)}
$$
  - **缺点**：
    - 易受 **背景噪声影响**，导致 **信号与噪声界限模糊**。
    - 对 **弱微震事件的检测性能较低**。

### **3. 近年来人工智能（AI）在 P 波 FAP 识别中的应用**

- **Zhu 等人（2021）**：
  - 提出 **基于统计分析（DA）、机器学习（Logistic Regression、kNN、SVM）和 CNN 深度学习** 的 P 波 FAP 分类模型。
  - CNN 方法超越 STA/LTA 方法，但分类准确率仅 **91.71%**，仍存在提升空间。

- **U-Net 在 FAP 识别中的应用**：
  - **Zhang 等人（2022）**：提出 **MT-Net**，结合 **U-Net 和多通道数据**，提高 **地震相位和 FAP 识别准确率**。
  - **Guo（2023）**：提出 **U-Net++**，采用 **更深层网络结构**，提高检测精度。
  - **问题**：
    - 尽管 **U-Net 结构表现优异**，但在 **SSIM（结构相似性）和 PSNR（峰值信噪比）** 评估下仍有残留误差，影响检测可靠性。
### **4. 本研究贡献**
..
---
## 2.P-wave FAP model
### **2.1 研究流程**
- **使用 SMSIM（随机模型仿真）** 生成 **不同振幅的地震信号**，并 **针对韩国地质环境建模**。
- **引入高斯白噪声（WGN）**，模拟 **真实背景噪声**，并进行 **信号预处理**：
  - **短时傅里叶变换（STFT）** 将 **一维信号转换为二维频谱图**，便于深度学习提取特征。
- **采用 U-Net 结构** 设计 **P 波 FAP 检测模型**，并 **调整超参数** 以优化检测性能。
- **模型性能评估** 采用 **MSE、MAE、RMSE、SSIM 和 PSNR**，验证 **检测的可靠性和稳定性**。
### **2.2 研究贡献**
..

![Image](https://github.com/user-attachments/assets/c4146ea4-1198-4ddc-a5b8-cb75b92e4da6)

---
## 3. Experimental Details 
### **3.1 地震信号数据**
#### **1. 真实数据集的挑战**
- 采集真实地震信号需要 **安装传感器**，并进行 **人工核验 P 波 FAP**，但 **数据获取成本高，难以满足深度学习训练需求**。
#### **2. 使用 SMSIM 生成合成地震数据**- 采用 **SMSIM（随机模型仿真）**，**加入高斯白噪声（WGN）**
#### **3. 频谱图转换**- 通过 **短时傅里叶变换（STFT）** 将 **地震波形转换为频谱图**，增强 **P 波特征提取能力**。
#### **4. 数据覆盖范围**
- 生成数据涵盖 **不同震级、震源深度、震中距**，并包括 **高噪声环境下的信号**，提高模型的泛化能力。
- **表 2** 详细列出了 **应力降、质量因子、震级和震中距**，确保数据符合 **真实地震的传播特性**。
- **图 2** 结果表明 **信号振幅随震级增加而增大，随震中距增加而减小**，验证了 **SMSIM 生成数据的合理性**。

### **3.2 WGN（白高斯噪声）在地震信号处理中的应用**

#### **1. WGN 的基本概念**
- **白高斯噪声（White Gaussian Noise, WGN）** 是**信号处理和概率论中的关键概念**，表示**服从高斯分布的随机噪声**。
- **WGN 的特点**：
  - **均值为 0**，方差为 \( \sigma^2 \)，满足正态分布。
  - **可用于模拟环境背景噪声**，广泛应用于 **信号分析、通信系统设计、实验与仿真** 等领域。
- **数学模型**：

$$
  \text{PDF}(x) = \frac{1}{\sigma \sqrt{2\pi}} \times \exp \left( -\frac{1}{2} \left( \frac{x - \mu}{\sigma} \right)^2 \right)
  $$

  - **\( \mu \)**：均值（本研究中 \( \mu = 0 \)）。
  - **\( \sigma \)**：标准差，控制噪声强度。

#### **2. WGN 在地震信号处理中的作用**
  - **用于添加噪声**，模拟真实环境下的地震数据。
  - **用于建立噪声模型**，提高地震数据分析的可靠性。
- **WGN 可以表示为时间序列信号**：

$$
  x(t) = N(0, \sigma^2)
$$

  - **\( x(t) \)**：时间 \( t \) 处的噪声值，服从高斯分布。
- **噪声信号的生成**：
  - 通过向原始信号 \( s(t) \) 添加 WGN，得到噪声信号：

$$
    p(t) = s(t) + x(t)
    $$

  - **\( p(t) \)**：添加 WGN 后的信号。
  - **\( s(t) \)**：原始地震信号。
  - **\( x(t) \)**：WGN 噪声。

#### **3. SNR（信噪比）计算**
- **SNR（Signal-to-Noise Ratio）** 用于衡量信号相对于噪声的相对强度：

$$
  \text{SNR} = \frac{P_s}{P_n} = 10 \log_{10} \left( \frac{\sigma_s}{\sigma_n} \right)
  $$

  - **\( P_s \)**：信号功率。
  - **\( P_n \)**：噪声功率。
  - **\( \sigma_s \)** 和 **\( \sigma_n \)** 分别是信号和噪声的标准差。
- **总信号功率计算**：

$$
  P = L \times \frac{1}{N} \sum_{i=0}^{N-1} |S_i|^2
  $$

  - **\( P \)**：信号功率。
  - **\( L \)**：缩放因子，调节噪声水平。
  - **\( N \)**：信号样本数。
  - **\( S_i \)**：单个信号样本点的值。

##### **4. WGN 对地震信号的影响**
- **影响因素**：
  - **震中距（Epicentral Distance）**：
    - **震中距越近** → **信号振幅大**，WGN 影响小。
    - **震中距越远** → **信号振幅衰减**，WGN 影响增大。
  - **震级（Magnitude）**：
    - **震级高** → **信号能量大**，WGN 干扰小。
    - **震级低** → **信号能量小**，WGN 影响显著。
- **实验验证（图 3, 4）**：
  - **使用 WGN 合成地震信号**，测试不同 SNR 对信号的影响。
  - **SNR 变化情况**：
    - **SNR 高（> 0 dB）** → 信号清晰，WGN 影响小。
    - **SNR 低（≤ -10 dB）** → 信号模糊，WGN 影响显著。
  - **不同噪声环境下的数据集**：
    - **清晰的 P 波 FAP 信号**（低噪声）。
    - **模糊的 P 波 FAP 信号**（中等噪声）。
    - **高背景噪声下的 P 波 FAP 信号**（高噪声）。

#### **5. 研究贡献**
- **构建 WGN 合成地震数据集**，提高模型的 **抗噪性**。
- **调整 SNR（-1, -5, -10 dB）**，生成 **30,000 条地震信号**，测试 **深度学习模型在不同噪声水平下的检测能力**。
- **证明 WGN 影响随震级、震中距变化**：
  - 震级高、震中距短 → **信号强，WGN 影响小**。
  - 震级低、震中距长 → **信号弱，WGN 影响大**。

### **3.3 频谱图转换（Spectrogram Transformation）**

#### **1. 研究目标**
- **采用 STFT（短时傅里叶变换）进行频谱图转换**，分析 **30,000 条地震信号** 的时频特性。
- **研究不同窗口大小（Window Size）对 P 波 FAP 识别的影响**，优化频谱图生成策略，以增强深度学习模型的检测能力。

#### **2. STFT 变换原理**
- **STFT（短时傅里叶变换）** 将 **一维时间信号转换为二维频谱图**：

$$
  STFT(t, \omega) = \int_{-\infty}^{\infty} x(\tau) \omega(\tau - t) e^{-j\omega\tau} d\tau
  $$

  - **\( x(\tau) \)**：原始信号函数。
  - **\( \omega(\tau - t) \)**：窗口函数（控制计算区域）。
- **离散化计算**：

$$
  STFT(m, l) = \sum_{n=-\infty}^{\infty} x(n) \omega(n - m) e^{-2\pi j n l / L}
  $$
  - 由于地震信号是离散的，STFT 通过 **分段计算** 进行时频分析。

#### **3. 频谱图转换的实验**
- **使用 Python SciPy 进行 STFT 计算**，并尝试不同窗口大小：
  - **窗口小** → 时间分辨率高，频率分辨率低，导致 P 波 FAP 参考点模糊。
  - **窗口大** → 频率分辨率高，时间分辨率低，使 P 波 FAP 关键点变得不清晰。
  - **目标**：**找到最佳窗口大小**，确保 FAP 识别的准确性。

#### **4. 频谱图数据集**
- **数据预处理**（图 6 展示示例）：
  1. **SMSIM 生成原始地震信号**。
  2. **转换为频谱图**，分析其时频特性。
  3. **加入 WGN 噪声**，模拟真实环境中的噪声信号。
  4. **构建 P 波 FAP 标注点**，用于监督学习。
- **数据构建**：
  - **30,000 张频谱图** 作为 **U-Net 输入**。
  - **30,000 个 P 波 FAP 参考点** 作为 **U-Net 目标输出**。
  - **总数据量：60,000 个数据点**，训练集 60%，验证集 20%，测试集 20%。

#### **5. 研究贡献**
- **验证窗口大小对 P 波 FAP 识别的影响**，优化 STFT 计算策略。
- **构建 30,000 条高质量频谱图数据集**，提升深度学习模型的训练效果。
- **综合测试不同 SNR（信噪比）条件**，确保模型在高噪声环境下仍能稳定识别 P 波 FAP。

![Image](https://github.com/user-attachments/assets/d5d3df89-8d6a-4dc9-a5ad-09bf7c310389)

## 3.4. U-Net Model
### **3.4.1 U-Net 结构**
- U-Net 由 **编码器（Encoder）和解码器（Decoder）** 组成，采用 **对称结构** 。
- **编码器**：卷积（Conv 3×3）+ ReLU + 最大池化（Max Pooling）。
- **解码器**：上采样（Upsampling）+ 反卷积（Conv Transpose）。
- 采用 **跳跃连接（Skip Connections）**，增强 P 波 FAP 识别能力。
- 研究优化 **窗口大小、卷积层深度** 以适配地震信号数据。
### **3.4.2 超参数优化（Hyperparameter Optimization）**
#### **1. 训练参数**
- **优化器**：Adam（自适应优化）
- **学习率**：0.01, 0.001, 0.0001, 0.00001（逐步降低）
- **批量大小**：64
- **训练周期**：100
- **损失函数**：MSE（均方误差）

#### **2. 学习率调整（ReduceLROnPlateau）**
- **Patience**：2（若 2 个 Epoch 训练无提升，则调整学习率）
- **最小学习率**：0.001 × 当前学习率
- **衰减因子**：0.5（每次调整学习率 × 0.5）

#### **3. 模型检查点（ModelCheckpoint）**
- **基于 PSNR 选择最佳模型**
- **每 1 个 Epoch 进行检查点保存**

### **3.4.3 模型评估指标（Model Evaluation Metrics）**
#### **1. 主要评估指标**
- **MSE（均方误差）**：
  - 衡量预测图像与真实图像之间的像素级误差。

$$
    MSE = \frac{1}{N} \sum_{i=1}^{n} (\hat{y}_i - y_i)^2
    $$
  - **MSE 越低，模型精度越高**。

- **PSNR（峰值信噪比）**：
  - 衡量预测图像与真实图像之间的质量损失。

$$
    PSNR = 10 \log_{10} \left( \frac{R^2}{MSE} \right)
    $$
  - **PSNR 越高，图像质量越好**。

- **SSIM（结构相似性指数）**：
  - 衡量图像在亮度、对比度和结构上的相似性。

$$
    SSIM(x, y) = \frac{(2\mu_x\mu_y + c_1)(2\sigma_{xy} + c_2)}{(\mu_x^2 + \mu_y^2 + c_1)(\sigma_x^2 + \sigma_y^2 + c_2)}
    $$
  - **SSIM 越接近 1，图像相似度越高**。


---
## 4. Experimental Results
 ### **4.1 U-Net 训练与验证结果**
#### **1. 训练趋势**
- 随着 **Epoch 增加**，MSE 下降，SSIM & PSNR 上升，模型稳定收敛。
- **窗口大小 64 & 重叠 32** 是最优选择，MSE = 0.006, SSIM = 0.943, PSNR = 22.296。
#### **2. 不同 SNR 的影响**
..
#### **3. 研究贡献**
- **确定窗口大小 64 为最优参数，提高 P 波 FAP 识别效果**。
- **调整学习率优化高噪声数据处理，提高模型泛化能力**。
- **U-Net 适用于 SNRdB = -1 至 -10 的地震信号，鲁棒性强**。

![Image](https://github.com/user-attachments/assets/56f4ef6a-9997-48b8-858b-044e79c28f0c)
### **4.2 U-Net 模型评估与地震信号 P 波 FAP 预测**
#### **1. 评估实验**
- **目标**：测试 U-Net 模型在不同 SNR（信噪比）环境下的 P 波 FAP 识别能力。
- **测试集**：共 6000 条数据，窗口大小 64，SNRdB 设定为 **-1、-5、-10**。
- **评估指标**：
  - **MSE（均方误差）**：预测误差的大小。
  - **SSIM（结构相似性指数）**：预测图像与真实图像的相似度。
  - **PSNR（峰值信噪比）**：预测图像的质量。
#### **2. 评估结果**
- **整体趋势**：
  - **MSE 随噪声增加而上升**，表示预测误差增大。
  - **SSIM 在 SNRdB = -1 时最高**，说明低噪声环境下 U-Net 预测最准确。
  - **PSNR 在 SNRdB = -10 时明显下降**，图像质量受噪声影响较大。

##### **（1）SNRdB = -1（低噪声）**
- **最佳预测性能**：
  - **MSE = 0.006**
  - **SSIM = 0.943**
  - **PSNR = 22.23**
- **分析**：
  - **P 波 FAP 特征清晰，U-Net 预测无误**。
  - **即使 FAP 位置稍有模糊，模型仍能准确检测**。

##### **（2）SNRdB = -5（中等噪声）**
- **预测性能**：
  - **MSE = 0.0061**
  - **SSIM = 0.943**
  - **PSNR = 22.18**
- **分析**：
  - **WGN 信号干扰增强，输入图像质量下降**。
  - **P 波 FAP 仍然可识别，但预测精度略有下降**。

##### **（3）SNRdB = -10（高噪声）**
- **预测性能**：
  - **MSE = 0.0064**
  - **SSIM = 0.942**
  - **PSNR = 21.92**
- **分析**：
  - **输入图像质量下降更严重，FAP 变得模糊**。
  - **尽管噪声极高，U-Net 仍然能够检测 P 波 FAP**，但 SSIM 和 PSNR 明显下降。

#### **3. 预测结果可视化**
- **图 11（SNRdB = -1）**
  - **(a)**：FAP 清晰 → 预测无误。
  - **(b)**：FAP 较模糊 → 仍然预测正确。

- **图 12（SNRdB = -5）**
  - **WGN 干扰增强，FAP 变得模糊**，导致预测精度下降。

- **图 13（SNRdB = -10）**
  - **极端噪声环境下，FAP 仍然可识别**，但图像质量下降。
  
---
## 5.Discussion and Comparison with Similar Works
### **1. 以往研究的特点**
- **使用时序地震信号或添加 WGN 噪声的信号** 作为 U-Net 训练数据。
- **主要优化深度学习框架的超参数和结构**（如 CNN、RNN、U-Net）。
### **2. 本研究的创新**
- **提出 STFT + U-Net 方法**，使用 **2D 频谱图** 作为输入数据。
- **相比直接使用时序信号，频谱图包含更多 P 波特征信息**，提高检测性能。
- **STFT + U-Net 在 P 波 FAP 识别中表现更优**，提高了 U-Net 对 P 波特征的学习能力。
### **3. 研究对比**
| **方法** | **MSE（均方误差）** | **MAE（平均绝对误差）** |
|---------|----------------|----------------|
| 以往研究 [25, 27] | 0.06 | 1.21 |
| **本研究（STFT + U-Net）** | **0.0031** | **0.0177** |

- **MSE 下降 19.35 倍**，表明预测误差显著减少。
- **MAE 下降 68.42 倍**，说明模型预测更接近真实值。

---
##  **6. 结论**
### **1. 研究方法**
- **使用 SMSIM 生成地震信号，合成 WGN 模拟噪声**。
- **使用 STFT 频谱图转换地震信号，并训练基于 U-Net 的 P 波 FAP 识别模型**。
- **通过超参数优化，提高 U-Net 检测 P 波 FAP 的能力**。
### **2. 研究成果**
- **模型在无噪声和高噪声环境下均成功检测 P 波 FAP，误差较低**。
- **在 SNRdB = -1 至 -10 之间均表现良好，证明模型的抗噪能力**。
- **可应用于微震监测、地震预警等多个领域，提高地震事件的预测精度**。
### **3. 现存问题**
- **PSNR 下降表明高噪声环境仍影响图像质量**。
- **需要进一步优化背景噪声去除，提高模型在真实环境中的适应性**。
### **4. 未来研究**
- **探索不同深度学习架构（如 Transformer、ResNet）以优化 P 波 FAP 识别**。
- **研究新的背景噪声去除方法，减少信号干扰**。
- **使用真实地震数据进行训练和验证，提高模型泛化能力**。

























[Paper Link](https://www.mdpi.com/2079-9292/13/1/229#:~:text=spectrogram%20images%20and%20used%20as,precise%20FAP%20detection%20capabilities%20in)