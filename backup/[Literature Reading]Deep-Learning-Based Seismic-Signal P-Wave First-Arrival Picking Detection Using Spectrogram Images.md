## Abstract

- **P波首波拾取（First-Arrival Picking, FAP）** 对多个工业领域至关重要，包括**煤炭与石油勘探、隧道施工、水力压裂和地震预警系统**。
- 现有方法包括：
  - **人工识别**：耗时且易受主观误差影响。
  - **STA/LTA 算法**：基于**短时平均（STA）/长时平均（LTA）** 的比值计算，但在**实时背景噪声**下性能下降。
- **本研究提出了一种基于 U-Net 深度学习模型的新方法**，结合 **频谱图转换（Spectrogram Transformation）** 处理地震信号，以提高P波FAP的检测精度。
- **数据处理步骤**：
  1. **模拟地震信号**：使用 **随机模型仿真程序** 生成**类似于韩国地震环境**的地震信号。
  2. **添加高斯白噪声（WGN）**，模拟真实环境中的背景噪声。
  3. **转换为二维频谱图**，用于 **U-Net 模型训练**，确保高精度P波FAP检测。
- **实验结果**： **均方误差（MSE）**    **平均绝对误差（MAE）**    **均方根误差（RMSE）** 
---
## Introduction
 ### **1. 研究背景**
- **微震监测技术（Microseismic Monitoring Technology）** 的核心在于 **精准检测 P 波首波（FAP, First-Arrival Picking）**。
- **微震事件来源**：
  - **自然微震**：构造活动、火山喷发。
  - **工业诱发微震**：煤炭与石油勘探、隧道施工、水力压裂、地热发电。
- **水力压裂（Hydraulic Fracturing）** 作为 **页岩气开采的核心技术**，但 **可能增加地震活动风险**：**高压流体注入** 导致 **孔隙压力变化**，可能诱发地震。

### **2. 现有 P 波 FAP 检测方法及其局限性**

- **人工检测（Manual Detection）**：
  - **依赖地震学家的经验**，但 **耗时、数据密集，易受主观误差影响**，降低可靠性。
- **STA/LTA 算法（Short-Term Average / Long-Term Average）**：
  - 计算 **短时平均（STA）/ 长时平均（LTA）** 的比值，检测信号突变：
  
$$
    R(t) = \frac{\text{STA}(t)}{\text{LTA}(t)}
$$
  - **缺点**：
    - 易受 **背景噪声影响**，导致 **信号与噪声界限模糊**。
    - 对 **弱微震事件的检测性能较低**。

### **3. 近年来人工智能（AI）在 P 波 FAP 识别中的应用**

- **Zhu 等人（2021）**：
  - 提出 **基于统计分析（DA）、机器学习（Logistic Regression、kNN、SVM）和 CNN 深度学习** 的 P 波 FAP 分类模型。
  - CNN 方法超越 STA/LTA 方法，但分类准确率仅 **91.71%**，仍存在提升空间。

- **U-Net 在 FAP 识别中的应用**：
  - **Zhang 等人（2022）**：提出 **MT-Net**，结合 **U-Net 和多通道数据**，提高 **地震相位和 FAP 识别准确率**。
  - **Guo（2023）**：提出 **U-Net++**，采用 **更深层网络结构**，提高检测精度。
  - **问题**：
    - 尽管 **U-Net 结构表现优异**，但在 **SSIM（结构相似性）和 PSNR（峰值信噪比）** 评估下仍有残留误差，影响检测可靠性。
### **4. 本研究贡献**
..
---
## 2.P-wave FAP model
### **2.1 研究流程**
- **使用 SMSIM（随机模型仿真）** 生成 **不同振幅的地震信号**，并 **针对韩国地质环境建模**。
- **引入高斯白噪声（WGN）**，模拟 **真实背景噪声**，并进行 **信号预处理**：
  - **短时傅里叶变换（STFT）** 将 **一维信号转换为二维频谱图**，便于深度学习提取特征。
- **采用 U-Net 结构** 设计 **P 波 FAP 检测模型**，并 **调整超参数** 以优化检测性能。
- **模型性能评估** 采用 **MSE、MAE、RMSE、SSIM 和 PSNR**，验证 **检测的可靠性和稳定性**。
### **2.2 研究贡献**
..

![Image](https://github.com/user-attachments/assets/c4146ea4-1198-4ddc-a5b8-cb75b92e4da6)

---
## 3. Experimental Details 
### **3.1 地震信号数据**
#### **1. 真实数据集的挑战**
- 采集真实地震信号需要 **安装传感器**，并进行 **人工核验 P 波 FAP**，但 **数据获取成本高，难以满足深度学习训练需求**。
#### **2. 使用 SMSIM 生成合成地震数据**- 采用 **SMSIM（随机模型仿真）**，**加入高斯白噪声（WGN）**
#### **3. 频谱图转换**- 通过 **短时傅里叶变换（STFT）** 将 **地震波形转换为频谱图**，增强 **P 波特征提取能力**。
#### **4. 数据覆盖范围**
- 生成数据涵盖 **不同震级、震源深度、震中距**，并包括 **高噪声环境下的信号**，提高模型的泛化能力。
- **表 2** 详细列出了 **应力降、质量因子、震级和震中距**，确保数据符合 **真实地震的传播特性**。
- **图 2** 结果表明 **信号振幅随震级增加而增大，随震中距增加而减小**，验证了 **SMSIM 生成数据的合理性**。

### **3.2 WGN（白高斯噪声）在地震信号处理中的应用**

#### **1. WGN 的基本概念**
- **白高斯噪声（White Gaussian Noise, WGN）** 是**信号处理和概率论中的关键概念**，表示**服从高斯分布的随机噪声**。
- **WGN 的特点**：
  - **均值为 0**，方差为 \( \sigma^2 \)，满足正态分布。
  - **可用于模拟环境背景噪声**，广泛应用于 **信号分析、通信系统设计、实验与仿真** 等领域。
- **数学模型**：

$$
  \text{PDF}(x) = \frac{1}{\sigma \sqrt{2\pi}} \times \exp \left( -\frac{1}{2} \left( \frac{x - \mu}{\sigma} \right)^2 \right)
  $$

  - **\( \mu \)**：均值（本研究中 \( \mu = 0 \)）。
  - **\( \sigma \)**：标准差，控制噪声强度。

#### **2. WGN 在地震信号处理中的作用**
  - **用于添加噪声**，模拟真实环境下的地震数据。
  - **用于建立噪声模型**，提高地震数据分析的可靠性。
- **WGN 可以表示为时间序列信号**：

$$
  x(t) = N(0, \sigma^2)
$$

  - **\( x(t) \)**：时间 \( t \) 处的噪声值，服从高斯分布。
- **噪声信号的生成**：
  - 通过向原始信号 \( s(t) \) 添加 WGN，得到噪声信号：

$$
    p(t) = s(t) + x(t)
    $$

  - **\( p(t) \)**：添加 WGN 后的信号。
  - **\( s(t) \)**：原始地震信号。
  - **\( x(t) \)**：WGN 噪声。

#### **3. SNR（信噪比）计算**
- **SNR（Signal-to-Noise Ratio）** 用于衡量信号相对于噪声的相对强度：

$$
  \text{SNR} = \frac{P_s}{P_n} = 10 \log_{10} \left( \frac{\sigma_s}{\sigma_n} \right)
  $$

  - **\( P_s \)**：信号功率。
  - **\( P_n \)**：噪声功率。
  - **\( \sigma_s \)** 和 **\( \sigma_n \)** 分别是信号和噪声的标准差。
- **总信号功率计算**：

  $$
  P = L \times \frac{1}{N} \sum_{i=0}^{N-1} |S_i|^2
  $$

  - **\( P \)**：信号功率。
  - **\( L \)**：缩放因子，调节噪声水平。
  - **\( N \)**：信号样本数。
  - **\( S_i \)**：单个信号样本点的值。

##### **4. WGN 对地震信号的影响**
- **影响因素**：
  - **震中距（Epicentral Distance）**：
    - **震中距越近** → **信号振幅大**，WGN 影响小。
    - **震中距越远** → **信号振幅衰减**，WGN 影响增大。
  - **震级（Magnitude）**：
    - **震级高** → **信号能量大**，WGN 干扰小。
    - **震级低** → **信号能量小**，WGN 影响显著。
- **实验验证（图 3, 4）**：
  - **使用 WGN 合成地震信号**，测试不同 SNR 对信号的影响。
  - **SNR 变化情况**：
    - **SNR 高（> 0 dB）** → 信号清晰，WGN 影响小。
    - **SNR 低（≤ -10 dB）** → 信号模糊，WGN 影响显著。
  - **不同噪声环境下的数据集**：
    - **清晰的 P 波 FAP 信号**（低噪声）。
    - **模糊的 P 波 FAP 信号**（中等噪声）。
    - **高背景噪声下的 P 波 FAP 信号**（高噪声）。

#### **5. 研究贡献**
- **构建 WGN 合成地震数据集**，提高模型的 **抗噪性**。
- **调整 SNR（-1, -5, -10 dB）**，生成 **30,000 条地震信号**，测试 **深度学习模型在不同噪声水平下的检测能力**。
- **证明 WGN 影响随震级、震中距变化**：
  - 震级高、震中距短 → **信号强，WGN 影响小**。
  - 震级低、震中距长 → **信号弱，WGN 影响大**。


































[Paper Link](https://www.mdpi.com/2079-9292/13/1/229#:~:text=spectrogram%20images%20and%20used%20as,precise%20FAP%20detection%20capabilities%20in)